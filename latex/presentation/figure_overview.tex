\begin{figure}
	\makebox[\textwidth][c]{
		\centering
		\begin{tikzpicture}[font=\scriptsize, align=center, node distance = 6mm and 6mm]
				\node[draw=blue!80,thick, above left, align=center, text width=58mm, minimum height=14mm] (a) {
					\textbf{Discrete ResNet}\\
					$\begin{cases}
						\text{Min~} & \frac{\nu \cdot L}{2} \sum_{k=1}^{L} \norm{v_k}_\cV^2
						+ l_R(\Phi_L(X), Y) \\
						\text{s.t.~} & v_1, \ldots, v_L \in \cV,\ \Phi_L = (I + v_L) \circ \ldots \circ (I + v_1)
					\end{cases}$};
				\node[right=of a, align=center,outer sep=-2em] (z1) {$\stackrel{L \rightarrow \infty}{\longrightarrow}$};
				\node[draw, right= of z1, align=center,text width=55mm, minimum height=14mm] (b) {
					\textbf{Countinuous Limit of ResNet}\\
					$\begin{cases}
						\text{Min~}& \frac{\nu}{2} \int_{0}^{1} \norm{v}_\mathcal{V}^2 \mathrm{d}t
						+ l(\phi_v(X, 1), Y)\\
						\text{s.t.~}& v \in C([0, 1], \mathcal{V}),\ \Phi_v(x, 0) = x,\\
						&\dot{\Phi}_v(x, t) = \mathbf{\Gamma}(\Phi_v(x, t), q(t)) \bGamma(q(t), q(t))^{-1} \dot{q}(t)
					\end{cases}$};
				\node[below= of a,outer sep=-2em] (z2) {\large{$\Updownarrow$}};
				\node[draw=blue!80, thick, below= of z2, align=center, text width=58mm, minimum height=18mm] (c) {
					\textbf{Discrete Least Action}\\
					$\begin{cases}
						\text{Min~} & \frac{\nu}{2} \sum_{k=1}^{L} \left(\frac{q_{k+1} - q_k}{\Delta t}\right)^\mathrm{T} \bGamma(q_k, q_k)^{-1} \left(\frac{q_{k+1} - q_k}{\Delta t}\right) \Delta t\\
						&+ l(q_{L+1}, Y) \\
						\text{s.t.~} & q_1 = X,\ q_2, \ldots, q_{L+1} \in \cX^N,\ \Delta t = \frac{1}{L}\\
						& v_k(x) = \bGamma(x, q_k)^\mathrm{T}\bGamma(q_k, q_k)^{-1} (q_{k+1} - q_k)
					\end{cases}$};
				\node[below= of b,outer sep=-2em] (z3) {\large{$\Updownarrow$} };
				\node[right=of c, align=center,outer sep=-2em] (z4) {$\stackrel{L \rightarrow \infty}{\longrightarrow}$};
				\node[draw=blue!80,thick, below= of z3, right=of z4, align=center, text width=55mm, minimum height=18mm] (d) {
					\textbf{Continuous Least Action}\\
					$\begin{cases}
					\text{Min~} & \frac{\nu}{2} \int_{0}^{1} \dot{q}(t)^\mathrm{T} \mathbf{\Gamma}(q(t), q(t))^{-1}  \dot{q}(t) \mathrm{d}t + l(q(1), Y)\\
					\text{s.t.~} & q \in C^1([0,1], \cX^N),\ q(0) = X
					\end{cases}$};
				\node[below= of d,outer sep=-2em] (z5) {\large{$\Updownarrow$}};
				\node[draw=blue!80,thick, below= of z5, align=center, text width=55mm, minimum height=18mm] (e) {
					\textbf{Geodesic Shooting}\\
					$\begin{cases}
						\text{Min~} & \frac{\nu}{2} p(0)^\T \bGamma(X, X)p(0) + l(q(1), Y)\\
						\text{s.t.~} & 	p = \bGamma(q, q)^{-1}\dot{q},\ q(0) = X,\ \dot{q} = \bGamma(q, q) p,\\
						&\dot{p} = -\grad_q \left(\frac{1}{2} p^\mathrm{T} \bGamma(q, q) p\right)
					\end{cases}$};
				\node[below= of c,outer sep=-2em] (z6) {\large{$\Updownarrow$}};
				\node[draw, below= of z6, align=center, text width=58mm, minimum height=18mm] (f) {
					\textbf{Discrete Geodesic Shooting}\\
					$\begin{cases}
					\text{Min~} & \frac{\nu}{2} \sum_{k=1}^L p_k^\T \bGamma(q_k, q_k) p_k \Delta t + l(q_{L+1}, Y)\\
					\text{s.t.~} & p_k = \bGamma(q_k, q_k)^{-1} \frac{q_{k+1} - q_k}{\Delta t},\ q_1 = X \\
					& q_{k+1} = q_k + \Delta t \bGamma(q_k, q_k) p_k,\\
					& p_{k+1} = p_k + \frac{\Delta t}{2} \grad_{q_k} \left(p_k^\T \bGamma(q_k, q_k) p_k\right)
					\end{cases}$};
				\node[right=of f, align=center,outer sep=-2em] (z7) {$\stackrel{L \rightarrow \infty}{\longrightarrow}$};
		\end{tikzpicture}
	}
	\label{fig:convergence}
\end{figure}